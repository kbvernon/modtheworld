<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 11 Data Wrangling | Modeling the World with R</title>
  <meta name="description" content="This book provides a gentle yet comprehensive introduction to doing basic statistics in R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 11 Data Wrangling | Modeling the World with R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides a gentle yet comprehensive introduction to doing basic statistics in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 11 Data Wrangling | Modeling the World with R" />
  
  <meta name="twitter:description" content="This book provides a gentle yet comprehensive introduction to doing basic statistics in R." />
  

<meta name="author" content="Kenneth Blake Vernon" />


<meta name="date" content="2021-02-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="vector-indexing.html"/>
<link rel="next" href="whatisstats.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modeling the World with R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="acknowledgments.html"><a href="acknowledgments.html"><i class="fa fa-check"></i>Acknowledgments</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#who-is-this-bookdown-for"><i class="fa fa-check"></i><b>1.1</b> Who is this bookdown for?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#why-this-bookdown-project"><i class="fa fa-check"></i><b>1.2</b> Why this bookdown project?</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#pedagogy"><i class="fa fa-check"></i><b>1.3</b> Pedagogy</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#the-abelson-principle"><i class="fa fa-check"></i><b>1.4</b> The Abelson Principle</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#book-layout"><i class="fa fa-check"></i><b>1.5</b> Book layout</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#chapter-overviews"><i class="fa fa-check"></i><b>1.5.1</b> Chapter overviews</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#r-code-formatting"><i class="fa fa-check"></i><b>1.6</b> R code formatting</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#exercises-and-data"><i class="fa fa-check"></i><b>1.7</b> Exercises and data</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>2</b> R and RStudio</a><ul>
<li class="chapter" data-level="2.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#what-is-r"><i class="fa fa-check"></i><b>2.1</b> What is R?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#the-r-environment"><i class="fa fa-check"></i><b>2.1.1</b> The R Environment</a></li>
<li class="chapter" data-level="2.1.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#the-r-language"><i class="fa fa-check"></i><b>2.1.2</b> The R Language</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#why-r"><i class="fa fa-check"></i><b>2.2</b> Why R?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#its-free"><i class="fa fa-check"></i><b>2.2.1</b> It’s free!</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#its-statistics-made-easy"><i class="fa fa-check"></i><b>2.2.2</b> It’s statistics made easy</a></li>
<li class="chapter" data-level="2.2.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#its-pretty-figures"><i class="fa fa-check"></i><b>2.2.3</b> It’s pretty figures</a></li>
<li class="chapter" data-level="2.2.4" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#its-reproducible"><i class="fa fa-check"></i><b>2.2.4</b> It’s reproducible</a></li>
<li class="chapter" data-level="2.2.5" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#its-an-active-community"><i class="fa fa-check"></i><b>2.2.5</b> It’s an active community</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a><ul>
<li class="chapter" data-level="2.3.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#pane-layout"><i class="fa fa-check"></i><b>2.3.1</b> Pane layout</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="example-workflow.html"><a href="example-workflow.html"><i class="fa fa-check"></i><b>3</b> An Example Workflow</a><ul>
<li class="chapter" data-level="3.1" data-path="example-workflow.html"><a href="example-workflow.html#in-fits-and-starts"><i class="fa fa-check"></i><b>3.1</b> In fits and starts</a></li>
<li class="chapter" data-level="3.2" data-path="example-workflow.html"><a href="example-workflow.html#the-whole-shebang"><i class="fa fa-check"></i><b>3.2</b> The whole shebang</a><ul>
<li class="chapter" data-level="3.2.1" data-path="example-workflow.html"><a href="example-workflow.html#load-data"><i class="fa fa-check"></i><b>3.2.1</b> Load data</a></li>
<li class="chapter" data-level="3.2.2" data-path="example-workflow.html"><a href="example-workflow.html#do-grunt-work"><i class="fa fa-check"></i><b>3.2.2</b> Do grunt work</a></li>
<li class="chapter" data-level="3.2.3" data-path="example-workflow.html"><a href="example-workflow.html#do-fun-stuff"><i class="fa fa-check"></i><b>3.2.3</b> Do fun stuff</a></li>
<li class="chapter" data-level="3.2.4" data-path="example-workflow.html"><a href="example-workflow.html#export-results"><i class="fa fa-check"></i><b>3.2.4</b> Export results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="looking-for-help.html"><a href="looking-for-help.html"><i class="fa fa-check"></i><b>4</b> Looking for Help</a><ul>
<li class="chapter" data-level="4.1" data-path="looking-for-help.html"><a href="looking-for-help.html#the-google-search-paradox"><i class="fa fa-check"></i><b>4.1</b> The Google Search Paradox</a></li>
<li class="chapter" data-level="4.2" data-path="looking-for-help.html"><a href="looking-for-help.html#helpful-helpers"><i class="fa fa-check"></i><b>4.2</b> Helpful helpers</a><ul>
<li class="chapter" data-level="4.2.1" data-path="looking-for-help.html"><a href="looking-for-help.html#r"><i class="fa fa-check"></i><b>4.2.1</b> R</a></li>
<li class="chapter" data-level="4.2.2" data-path="looking-for-help.html"><a href="looking-for-help.html#rstudio-help"><i class="fa fa-check"></i><b>4.2.2</b> RStudio</a></li>
<li class="chapter" data-level="4.2.3" data-path="looking-for-help.html"><a href="looking-for-help.html#r-community"><i class="fa fa-check"></i><b>4.2.3</b> R Community</a></li>
<li class="chapter" data-level="4.2.4" data-path="looking-for-help.html"><a href="looking-for-help.html#other-resources"><i class="fa fa-check"></i><b>4.2.4</b> Other Resources</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="looking-for-help.html"><a href="looking-for-help.html#reproducible-examples"><i class="fa fa-check"></i><b>4.3</b> Reproducible examples</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="r-style-guide.html"><a href="r-style-guide.html"><i class="fa fa-check"></i><b>5</b> R Style Guide</a><ul>
<li class="chapter" data-level="5.1" data-path="r-style-guide.html"><a href="r-style-guide.html#abelson-again"><i class="fa fa-check"></i><b>5.1</b> Abelson again</a></li>
<li class="chapter" data-level="5.2" data-path="r-style-guide.html"><a href="r-style-guide.html#be-verbose"><i class="fa fa-check"></i><b>5.2</b> Be verbose!</a><ul>
<li class="chapter" data-level="5.2.1" data-path="r-style-guide.html"><a href="r-style-guide.html#object-names"><i class="fa fa-check"></i><b>5.2.1</b> Object names</a></li>
<li class="chapter" data-level="5.2.2" data-path="r-style-guide.html"><a href="r-style-guide.html#function-parameters"><i class="fa fa-check"></i><b>5.2.2</b> Function parameters</a></li>
<li class="chapter" data-level="5.2.3" data-path="r-style-guide.html"><a href="r-style-guide.html#code-commenting"><i class="fa fa-check"></i><b>5.2.3</b> Code commenting</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="r-style-guide.html"><a href="r-style-guide.html#dont-repeat-yourself-dry"><i class="fa fa-check"></i><b>5.3</b> Don’t Repeat Yourself (DRY)</a></li>
<li class="chapter" data-level="5.4" data-path="r-style-guide.html"><a href="r-style-guide.html#assignment-first"><i class="fa fa-check"></i><b>5.4</b> Assignment first</a></li>
<li class="chapter" data-level="5.5" data-path="r-style-guide.html"><a href="r-style-guide.html#the-cratylus-rule"><i class="fa fa-check"></i><b>5.5</b> The Cratylus Rule</a></li>
<li class="chapter" data-level="5.6" data-path="r-style-guide.html"><a href="r-style-guide.html#empty-nests"><i class="fa fa-check"></i><b>5.6</b> Empty nests!</a></li>
<li class="chapter" data-level="5.7" data-path="r-style-guide.html"><a href="r-style-guide.html#be-open"><i class="fa fa-check"></i><b>5.7</b> Be open</a><ul>
<li class="chapter" data-level="5.7.1" data-path="r-style-guide.html"><a href="r-style-guide.html#spacing"><i class="fa fa-check"></i><b>5.7.1</b> Spacing</a></li>
<li class="chapter" data-level="5.7.2" data-path="r-style-guide.html"><a href="r-style-guide.html#line-length"><i class="fa fa-check"></i><b>5.7.2</b> Line Length</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="r-style-guide.html"><a href="r-style-guide.html#be-organized"><i class="fa fa-check"></i><b>5.8</b> Be organized</a></li>
</ul></li>
<li class="part"><span><b>I Introduction to R</b></span></li>
<li class="chapter" data-level="6" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>6</b> R Basics</a><ul>
<li class="chapter" data-level="6.1" data-path="r-basics.html"><a href="r-basics.html#overview"><i class="fa fa-check"></i><b>6.1</b> Overview</a></li>
<li class="chapter" data-level="6.2" data-path="r-basics.html"><a href="r-basics.html#a-glorified-calculator"><i class="fa fa-check"></i><b>6.2</b> A Glorified Calculator?</a></li>
<li class="chapter" data-level="6.3" data-path="r-basics.html"><a href="r-basics.html#objects-and-functions"><i class="fa fa-check"></i><b>6.3</b> Objects and Functions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="r-basics.html"><a href="r-basics.html#creating-objects-with-assignment"><i class="fa fa-check"></i><b>6.3.1</b> Creating objects with assignment</a></li>
<li class="chapter" data-level="6.3.2" data-path="r-basics.html"><a href="r-basics.html#doing-things-with-functions"><i class="fa fa-check"></i><b>6.3.2</b> Doing things with functions</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="r-basics.html"><a href="r-basics.html#vectorized-functions"><i class="fa fa-check"></i><b>6.4</b> Vectorized Functions</a></li>
<li class="chapter" data-level="6.5" data-path="r-basics.html"><a href="r-basics.html#console-and-scripts"><i class="fa fa-check"></i><b>6.5</b> Console and Scripts</a><ul>
<li class="chapter" data-level="6.5.1" data-path="r-basics.html"><a href="r-basics.html#r-console"><i class="fa fa-check"></i><b>6.5.1</b> R Console</a></li>
<li class="chapter" data-level="6.5.2" data-path="r-basics.html"><a href="r-basics.html#r-scripts"><i class="fa fa-check"></i><b>6.5.2</b> R Scripts</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="r-basics.html"><a href="r-basics.html#packages-in-the-r-library"><i class="fa fa-check"></i><b>6.6</b> Packages in the R Library</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="statistical-graphics.html"><a href="statistical-graphics.html"><i class="fa fa-check"></i><b>7</b> Statistical Graphics</a><ul>
<li class="chapter" data-level="7.1" data-path="statistical-graphics.html"><a href="statistical-graphics.html#overview-1"><i class="fa fa-check"></i><b>7.1</b> Overview</a></li>
<li class="chapter" data-level="7.2" data-path="statistical-graphics.html"><a href="statistical-graphics.html#plot-anatomy"><i class="fa fa-check"></i><b>7.2</b> Plot anatomy</a><ul>
<li class="chapter" data-level="7.2.1" data-path="statistical-graphics.html"><a href="statistical-graphics.html#region"><i class="fa fa-check"></i><b>7.2.1</b> Region</a></li>
<li class="chapter" data-level="7.2.2" data-path="statistical-graphics.html"><a href="statistical-graphics.html#sides"><i class="fa fa-check"></i><b>7.2.2</b> Sides</a></li>
<li class="chapter" data-level="7.2.3" data-path="statistical-graphics.html"><a href="statistical-graphics.html#axes"><i class="fa fa-check"></i><b>7.2.3</b> Axes</a></li>
<li class="chapter" data-level="7.2.4" data-path="statistical-graphics.html"><a href="statistical-graphics.html#titles"><i class="fa fa-check"></i><b>7.2.4</b> Titles</a></li>
<li class="chapter" data-level="7.2.5" data-path="statistical-graphics.html"><a href="statistical-graphics.html#margins"><i class="fa fa-check"></i><b>7.2.5</b> Margins</a></li>
<li class="chapter" data-level="7.2.6" data-path="statistical-graphics.html"><a href="statistical-graphics.html#legend"><i class="fa fa-check"></i><b>7.2.6</b> Legend</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="statistical-graphics.html"><a href="statistical-graphics.html#plot-function"><i class="fa fa-check"></i><b>7.3</b> The <code>plot()</code> Function</a><ul>
<li class="chapter" data-level="7.3.1" data-path="statistical-graphics.html"><a href="statistical-graphics.html#plot-type"><i class="fa fa-check"></i><b>7.3.1</b> Plot type</a></li>
<li class="chapter" data-level="7.3.2" data-path="statistical-graphics.html"><a href="statistical-graphics.html#plot-limits"><i class="fa fa-check"></i><b>7.3.2</b> Plot limits</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="statistical-graphics.html"><a href="statistical-graphics.html#layering"><i class="fa fa-check"></i><b>7.4</b> Layering</a></li>
<li class="chapter" data-level="7.5" data-path="statistical-graphics.html"><a href="statistical-graphics.html#annotation"><i class="fa fa-check"></i><b>7.5</b> Annotation</a></li>
<li class="chapter" data-level="7.6" data-path="statistical-graphics.html"><a href="statistical-graphics.html#graphical-parameters"><i class="fa fa-check"></i><b>7.6</b> Graphical parameters</a><ul>
<li class="chapter" data-level="7.6.1" data-path="statistical-graphics.html"><a href="statistical-graphics.html#region-1"><i class="fa fa-check"></i><b>7.6.1</b> Region</a></li>
<li class="chapter" data-level="7.6.2" data-path="statistical-graphics.html"><a href="statistical-graphics.html#geometry"><i class="fa fa-check"></i><b>7.6.2</b> Geometry</a></li>
<li class="chapter" data-level="7.6.3" data-path="statistical-graphics.html"><a href="statistical-graphics.html#text"><i class="fa fa-check"></i><b>7.6.3</b> Text</a></li>
<li class="chapter" data-level="7.6.4" data-path="statistical-graphics.html"><a href="statistical-graphics.html#color"><i class="fa fa-check"></i><b>7.6.4</b> Color</a></li>
<li class="chapter" data-level="7.6.5" data-path="statistical-graphics.html"><a href="statistical-graphics.html#size"><i class="fa fa-check"></i><b>7.6.5</b> Size</a></li>
<li class="chapter" data-level="7.6.6" data-path="statistical-graphics.html"><a href="statistical-graphics.html#margin"><i class="fa fa-check"></i><b>7.6.6</b> Margin</a></li>
<li class="chapter" data-level="7.6.7" data-path="statistical-graphics.html"><a href="statistical-graphics.html#layout"><i class="fa fa-check"></i><b>7.6.7</b> Layout</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="statistical-graphics.html"><a href="statistical-graphics.html#saving-figures"><i class="fa fa-check"></i><b>7.7</b> Saving figures</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="vector-types.html"><a href="vector-types.html"><i class="fa fa-check"></i><b>8</b> Vector Types</a><ul>
<li class="chapter" data-level="8.1" data-path="vector-types.html"><a href="vector-types.html#overview-2"><i class="fa fa-check"></i><b>8.1</b> Overview</a></li>
<li class="chapter" data-level="8.2" data-path="vector-types.html"><a href="vector-types.html#data-types"><i class="fa fa-check"></i><b>8.2</b> Data types</a><ul>
<li class="chapter" data-level="8.2.1" data-path="vector-types.html"><a href="vector-types.html#integer"><i class="fa fa-check"></i><b>8.2.1</b> Integer</a></li>
<li class="chapter" data-level="8.2.2" data-path="vector-types.html"><a href="vector-types.html#double"><i class="fa fa-check"></i><b>8.2.2</b> Double</a></li>
<li class="chapter" data-level="8.2.3" data-path="vector-types.html"><a href="vector-types.html#character"><i class="fa fa-check"></i><b>8.2.3</b> Character</a></li>
<li class="chapter" data-level="8.2.4" data-path="vector-types.html"><a href="vector-types.html#logical"><i class="fa fa-check"></i><b>8.2.4</b> Logical</a></li>
<li class="chapter" data-level="8.2.5" data-path="vector-types.html"><a href="vector-types.html#factors"><i class="fa fa-check"></i><b>8.2.5</b> Factors</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="vector-types.html"><a href="vector-types.html#vector-types-1"><i class="fa fa-check"></i><b>8.3</b> Vector types</a><ul>
<li class="chapter" data-level="8.3.1" data-path="vector-types.html"><a href="vector-types.html#scalar"><i class="fa fa-check"></i><b>8.3.1</b> Scalar</a></li>
<li class="chapter" data-level="8.3.2" data-path="vector-types.html"><a href="vector-types.html#vector"><i class="fa fa-check"></i><b>8.3.2</b> Vector</a></li>
<li class="chapter" data-level="8.3.3" data-path="vector-types.html"><a href="vector-types.html#matrix"><i class="fa fa-check"></i><b>8.3.3</b> Matrix</a></li>
<li class="chapter" data-level="8.3.4" data-path="vector-types.html"><a href="vector-types.html#list"><i class="fa fa-check"></i><b>8.3.4</b> List</a></li>
<li class="chapter" data-level="8.3.5" data-path="vector-types.html"><a href="vector-types.html#data.frame"><i class="fa fa-check"></i><b>8.3.5</b> Data.frame</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="vector-types.html"><a href="vector-types.html#vector-display"><i class="fa fa-check"></i><b>8.4</b> Vector display</a></li>
<li class="chapter" data-level="8.5" data-path="vector-types.html"><a href="vector-types.html#coercion"><i class="fa fa-check"></i><b>8.5</b> Coercion</a><ul>
<li class="chapter" data-level="8.5.1" data-path="vector-types.html"><a href="vector-types.html#data-type-coercion"><i class="fa fa-check"></i><b>8.5.1</b> Data type coercion</a></li>
<li class="chapter" data-level="8.5.2" data-path="vector-types.html"><a href="vector-types.html#vector-type-coercion"><i class="fa fa-check"></i><b>8.5.2</b> Vector type coercion</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="workspace-management.html"><a href="workspace-management.html"><i class="fa fa-check"></i><b>9</b> Workspace Management</a><ul>
<li class="chapter" data-level="9.1" data-path="workspace-management.html"><a href="workspace-management.html#overview-3"><i class="fa fa-check"></i><b>9.1</b> Overview</a></li>
<li class="chapter" data-level="9.2" data-path="workspace-management.html"><a href="workspace-management.html#the-workspace"><i class="fa fa-check"></i><b>9.2</b> The workspace</a><ul>
<li class="chapter" data-level="9.2.1" data-path="workspace-management.html"><a href="workspace-management.html#workspace-management-1"><i class="fa fa-check"></i><b>9.2.1</b> Workspace management</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="workspace-management.html"><a href="workspace-management.html#the-working-directory"><i class="fa fa-check"></i><b>9.3</b> The working directory</a><ul>
<li class="chapter" data-level="9.3.1" data-path="workspace-management.html"><a href="workspace-management.html#file-paths"><i class="fa fa-check"></i><b>9.3.1</b> File paths</a></li>
<li class="chapter" data-level="9.3.2" data-path="workspace-management.html"><a href="workspace-management.html#setting-the-working-directory"><i class="fa fa-check"></i><b>9.3.2</b> Setting the working directory</a></li>
<li class="chapter" data-level="9.3.3" data-path="workspace-management.html"><a href="workspace-management.html#reproducible-projects"><i class="fa fa-check"></i><b>9.3.3</b> Reproducible projects</a></li>
<li class="chapter" data-level="9.3.4" data-path="workspace-management.html"><a href="workspace-management.html#directory-management"><i class="fa fa-check"></i><b>9.3.4</b> Directory management</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="workspace-management.html"><a href="workspace-management.html#data-import-and-export"><i class="fa fa-check"></i><b>9.4</b> Data Import and Export</a><ul>
<li class="chapter" data-level="9.4.1" data-path="workspace-management.html"><a href="workspace-management.html#read-and-write-tables"><i class="fa fa-check"></i><b>9.4.1</b> Read and write tables</a></li>
<li class="chapter" data-level="9.4.2" data-path="workspace-management.html"><a href="workspace-management.html#read-and-save-objects"><i class="fa fa-check"></i><b>9.4.2</b> Read and save objects</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="vector-indexing.html"><a href="vector-indexing.html"><i class="fa fa-check"></i><b>10</b> Vector Indexing</a><ul>
<li class="chapter" data-level="10.1" data-path="vector-indexing.html"><a href="vector-indexing.html#overview-4"><i class="fa fa-check"></i><b>10.1</b> Overview</a></li>
<li class="chapter" data-level="10.2" data-path="vector-indexing.html"><a href="vector-indexing.html#index-vector-types"><i class="fa fa-check"></i><b>10.2</b> Index vector types</a><ul>
<li class="chapter" data-level="10.2.1" data-path="vector-indexing.html"><a href="vector-indexing.html#integer-indexing"><i class="fa fa-check"></i><b>10.2.1</b> Integer Indexing</a></li>
<li class="chapter" data-level="10.2.2" data-path="vector-indexing.html"><a href="vector-indexing.html#character-indexing"><i class="fa fa-check"></i><b>10.2.2</b> Character Indexing</a></li>
<li class="chapter" data-level="10.2.3" data-path="vector-indexing.html"><a href="vector-indexing.html#logical-indexing"><i class="fa fa-check"></i><b>10.2.3</b> Logical Indexing</a></li>
<li class="chapter" data-level="10.2.4" data-path="vector-indexing.html"><a href="vector-indexing.html#r-functions"><i class="fa fa-check"></i><b>10.2.4</b> R functions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="vector-indexing.html"><a href="vector-indexing.html#assignment-and-replacement"><i class="fa fa-check"></i><b>10.3</b> Assignment and Replacement</a></li>
<li class="chapter" data-level="10.4" data-path="vector-indexing.html"><a href="vector-indexing.html#complex-indexing"><i class="fa fa-check"></i><b>10.4</b> Complex Indexing</a><ul>
<li class="chapter" data-level="10.4.1" data-path="vector-indexing.html"><a href="vector-indexing.html#matrix-1"><i class="fa fa-check"></i><b>10.4.1</b> Matrix</a></li>
<li class="chapter" data-level="10.4.2" data-path="vector-indexing.html"><a href="vector-indexing.html#data.frame-1"><i class="fa fa-check"></i><b>10.4.2</b> Data.frame</a></li>
<li class="chapter" data-level="10.4.3" data-path="vector-indexing.html"><a href="vector-indexing.html#list-1"><i class="fa fa-check"></i><b>10.4.3</b> List</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="vector-indexing.html"><a href="vector-indexing.html#indexing-indexed-vectors"><i class="fa fa-check"></i><b>10.5</b> Indexing indexed vectors</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i><b>11</b> Data Wrangling</a><ul>
<li class="chapter" data-level="11.1" data-path="data-wrangling.html"><a href="data-wrangling.html#overview-5"><i class="fa fa-check"></i><b>11.1</b> Overview</a></li>
<li class="chapter" data-level="11.2" data-path="data-wrangling.html"><a href="data-wrangling.html#shaping-data"><i class="fa fa-check"></i><b>11.2</b> Shaping data</a></li>
<li class="chapter" data-level="11.3" data-path="data-wrangling.html"><a href="data-wrangling.html#transforming-data"><i class="fa fa-check"></i><b>11.3</b> Transforming data</a><ul>
<li class="chapter" data-level="11.3.1" data-path="data-wrangling.html"><a href="data-wrangling.html#arrange"><i class="fa fa-check"></i><b>11.3.1</b> Arrange</a></li>
<li class="chapter" data-level="11.3.2" data-path="data-wrangling.html"><a href="data-wrangling.html#change"><i class="fa fa-check"></i><b>11.3.2</b> Change</a></li>
<li class="chapter" data-level="11.3.3" data-path="data-wrangling.html"><a href="data-wrangling.html#filter"><i class="fa fa-check"></i><b>11.3.3</b> Filter</a></li>
<li class="chapter" data-level="11.3.4" data-path="data-wrangling.html"><a href="data-wrangling.html#select"><i class="fa fa-check"></i><b>11.3.4</b> Select</a></li>
<li class="chapter" data-level="11.3.5" data-path="data-wrangling.html"><a href="data-wrangling.html#combine"><i class="fa fa-check"></i><b>11.3.5</b> Combine</a></li>
<li class="chapter" data-level="11.3.6" data-path="data-wrangling.html"><a href="data-wrangling.html#clean"><i class="fa fa-check"></i><b>11.3.6</b> Clean</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Introduction to Statistics</b></span></li>
<li class="chapter" data-level="12" data-path="whatisstats.html"><a href="whatisstats.html"><i class="fa fa-check"></i><b>12</b> What is Statistics?</a></li>
<li class="chapter" data-level="13" data-path="univariate-description.html"><a href="univariate-description.html"><i class="fa fa-check"></i><b>13</b> Univariate Description</a></li>
<li class="chapter" data-level="14" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>14</b> Probability Distributions</a></li>
<li class="chapter" data-level="15" data-path="inference-tests.html"><a href="inference-tests.html"><i class="fa fa-check"></i><b>15</b> Inference Tests</a></li>
<li class="chapter" data-level="16" data-path="multivariate-description.html"><a href="multivariate-description.html"><i class="fa fa-check"></i><b>16</b> Multivariate Description</a></li>
<li class="chapter" data-level="17" data-path="ols.html"><a href="ols.html"><i class="fa fa-check"></i><b>17</b> Linear Models</a></li>
<li class="chapter" data-level="18" data-path="model-diagnostics.html"><a href="model-diagnostics.html"><i class="fa fa-check"></i><b>18</b> Model Diagnostics</a></li>
<li class="chapter" data-level="19" data-path="glm.html"><a href="glm.html"><i class="fa fa-check"></i><b>19</b> Generalized Linear Models</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modeling the World with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="data-wrangling" class="section level1">
<h1><span class="header-section-number">Chapter 11</span> Data Wrangling</h1>
<!-- include libraries -->
<!-- kableExtra bootstrap css 
https://haozhu233.github.io/kableExtra/bookdown/use-bootstrap-tables-in-gitbooks-epub.html
-->
<!-- knit_hook: collapse and strip white 
this is a Blake hack -->
<!-- knit_hook: collapse and print error red
super hacky, see here: https://stackoverflow.com/a/54985678/7705429
we'll need to be careful to not string four # together anywhere
--->
<script>
$(document).ready(function() {
  window.setTimeout(function() {
    $(".co:contains('####')").css("color", "red");
    var tmp = $(".co:contains('####')").text();
    $(".co:contains('####')").text(tmp.replace("####", "##"));
  }, 15);
});
</script>
<!-- chunk options -->
<!-- miscellaneous -->
<!-- 
make error messages closer to base R 
https://github.com/hadley/adv-r/blob/master/common.R
looks like it doesn't work because R no longer
let's users override s3 methods, so I changed the s3 to "simpleError"
-->
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<a href="https://github.com/allisonhorst/stats-illustrations" target="_blank"><img src="https://raw.githubusercontent.com/allisonhorst/stats-illustrations/master/rstats-artwork/data_cowboy.png" alt="Artwork by Allison Horst contributed to Hadley Wickham's talk &quot;The Joy of Functional Programming (for Data Science).&quot;" width="70%" /></a>
<p class="caption">
Figure 4.1: Artwork by Allison Horst contributed to Hadley Wickham’s talk “The Joy of Functional Programming (for Data Science).”
</p>
</div>
<div id="overview-5" class="section level2">
<h2><span class="header-section-number">11.1</span> Overview</h2>
<table class="table-intro table table-hover table-striped" style="margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;border: 0 solid transparent; padding-right: 0px; vertical-align: top;">
<strong>Goal</strong>
</td>
<td style="text-align:left;border: 0 solid transparent; padding-left: 9px; text-align: justify; text-justify: inter-word;">
To teach students how to clean, shape, and transform raw tabular data to make it suitable for statistical analysis.
</td>
</tr>
<tr>
<td style="text-align:left;border: 0 solid transparent; padding-right: 0px; vertical-align: top;">
<strong>tl;dr</strong>
</td>
<td style="text-align:left;border: 0 solid transparent; padding-left: 9px; text-align: justify; text-justify: inter-word;">
Wrangling data is challenging in any context, but at least it’s reproducible in R.
</td>
</tr>
<tr>
<td style="text-align:left;border: 0 solid transparent; padding-right: 0px; vertical-align: top;">
<strong>Outcomes</strong>
</td>
<td style="text-align:left;border: 0 solid transparent; padding-left: 9px; text-align: justify; text-justify: inter-word;">
Here, you will learn about<br>
<ol>
<li>
reshaping data.frames between wide and long format,
</li>
<li>
arranging data.frames by ordering along one or more variables or columns,
</li>
<li>
transforming data.frames by adding or changing variable or column values,
</li>
<li>
subsetting data.frames by filtering rows and selecting columns,
</li>
<li>
summarizing data.frames by aggregating factor variables,
</li>
<li>
combining data.frames by binding rows and/or columns, and
</li>
<li>
cleaning data.frames by handling missing values.
</li>
</ol>
</td>
</tr>
<tr>
<td style="text-align:left;border: 0 solid transparent; padding-right: 0px; vertical-align: top;">
<strong>Datasets</strong>
</td>
<td style="text-align:left;border: 0 solid transparent; padding-left: 9px; text-align: justify; text-justify: inter-word;">
<a href="https://tidyr.tidyverse.org/reference/table1.html">Tables</a> <span class="citation">(<span class="citeproc-not-found" data-reference-id="Wickham"><strong>???</strong></span>)</span>
</td>
</tr>
<tr>
<td style="text-align:left;border: 0 solid transparent; padding-right: 0px; vertical-align: top;">
<strong>Requirements</strong>
</td>
<td style="text-align:left;border: 0 solid transparent; padding-left: 9px; text-align: justify; text-justify: inter-word;">
<a href="r-basics.html#r-basics">Chapter 6: R Basics</a><br><a href="vector-types.html#vector-types">Chapter 8: Vector Types</a><br><a href="workspace-management.html#workspace-management">Chapter 9: Workspace Management</a>
</td>
</tr>
<tr>
<td style="text-align:left;border: 0 solid transparent; padding-right: 0px; vertical-align: top;">
<strong>Further Reading</strong>
</td>
<td style="text-align:left;border: 0 solid transparent; padding-left: 9px; text-align: justify; text-justify: inter-word;">
<a href="https://r4ds.had.co.nz/index.html">R For Data Science</a> <span class="citation">(<span class="citeproc-not-found" data-reference-id="Wickham"><strong>???</strong></span>)</span>
</td>
</tr>
</tbody>
</table>
<p>Data pre-processing, colloquially referred to as data <em>wrangling</em>, is the work you do to prepare your data for analysis in R. Typically, this involves getting your data into R, making sure it’s in the right shape or format, and making sure you have the right variables and observations. The first of these we already covered in <a href="workspace-management.html#workspace-management">Chapter 9: Workspace Management</a>. Here, we will focus on the latter aspects of data wrangling, shaping our data and transforming it. While these are far less glamorous than other parts of a statistical workflow, they are no less important. They will also gobble up the greater part of your research effort, even when done efficiently. So, we will spend quite a bit of time on these aspects of data wrangling. Please note that the focus here will be on wrangling data.frames.</p>

<div class="rmdnote">
This chapter borrows heavily from the tidy framework as detailed in <em>R for Data Science</em> <span class="citation">(<span class="citeproc-not-found" data-reference-id="Wickham"><strong>???</strong></span>)</span>, especially the arguments for a tidy format in the next section. The big difference is that it covers base R tools for tidying data, rather than those provided by the <code>tidyverse</code> family of R packages, which are in many ways more expressive and user-friendly. You can learn more about them at the <a href="https://www.tidyverse.org/">tidyverse website</a>.
</div>

</div>
<div id="shaping-data" class="section level2">
<h2><span class="header-section-number">11.2</span> Shaping data</h2>
<p><em>How should you organize your data in a table?</em> This might seem like a no-brainer. I mean, are there really that many options for structuring a table? The answer is Yes, there are, and each alternative confronts you with important trade-offs that affect the efficiency and reproducibility of your code. Consider these tables:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="data-wrangling.html#cb147-1"></a>table1</span>
<span id="cb147-2"><a href="data-wrangling.html#cb147-2"></a><span class="co">##       country year  cases population</span></span>
<span id="cb147-3"><a href="data-wrangling.html#cb147-3"></a><span class="co">## 1 Afghanistan 1999    745   19987071</span></span>
<span id="cb147-4"><a href="data-wrangling.html#cb147-4"></a><span class="co">## 2 Afghanistan 2000   2666   20595360</span></span>
<span id="cb147-5"><a href="data-wrangling.html#cb147-5"></a><span class="co">## 3      Brazil 1999  37737  172006362</span></span>
<span id="cb147-6"><a href="data-wrangling.html#cb147-6"></a><span class="co">## 4      Brazil 2000  80488  174504898</span></span>
<span id="cb147-7"><a href="data-wrangling.html#cb147-7"></a><span class="co">## 5       China 1999 212258 1272915272</span></span>
<span id="cb147-8"><a href="data-wrangling.html#cb147-8"></a><span class="co">## 6       China 2000 213766 1280428583</span></span>
<span id="cb147-9"><a href="data-wrangling.html#cb147-9"></a>table2</span>
<span id="cb147-10"><a href="data-wrangling.html#cb147-10"></a><span class="co">##        country year       type      count</span></span>
<span id="cb147-11"><a href="data-wrangling.html#cb147-11"></a><span class="co">## 1  Afghanistan 1999      cases        745</span></span>
<span id="cb147-12"><a href="data-wrangling.html#cb147-12"></a><span class="co">## 2  Afghanistan 1999 population   19987071</span></span>
<span id="cb147-13"><a href="data-wrangling.html#cb147-13"></a><span class="co">## 3  Afghanistan 2000      cases       2666</span></span>
<span id="cb147-14"><a href="data-wrangling.html#cb147-14"></a><span class="co">## 4  Afghanistan 2000 population   20595360</span></span>
<span id="cb147-15"><a href="data-wrangling.html#cb147-15"></a><span class="co">## 5       Brazil 1999      cases      37737</span></span>
<span id="cb147-16"><a href="data-wrangling.html#cb147-16"></a><span class="co">## 6       Brazil 1999 population  172006362</span></span>
<span id="cb147-17"><a href="data-wrangling.html#cb147-17"></a><span class="co">## 7       Brazil 2000      cases      80488</span></span>
<span id="cb147-18"><a href="data-wrangling.html#cb147-18"></a><span class="co">## 8       Brazil 2000 population  174504898</span></span>
<span id="cb147-19"><a href="data-wrangling.html#cb147-19"></a><span class="co">## 9        China 1999      cases     212258</span></span>
<span id="cb147-20"><a href="data-wrangling.html#cb147-20"></a><span class="co">## 10       China 1999 population 1272915272</span></span>
<span id="cb147-21"><a href="data-wrangling.html#cb147-21"></a><span class="co">## 11       China 2000      cases     213766</span></span>
<span id="cb147-22"><a href="data-wrangling.html#cb147-22"></a><span class="co">## 12       China 2000 population 1280428583</span></span>
<span id="cb147-23"><a href="data-wrangling.html#cb147-23"></a>table3 <span class="co"># count of cases</span></span>
<span id="cb147-24"><a href="data-wrangling.html#cb147-24"></a><span class="co">##       country   1999   2000</span></span>
<span id="cb147-25"><a href="data-wrangling.html#cb147-25"></a><span class="co">## 1 Afghanistan    745   2666</span></span>
<span id="cb147-26"><a href="data-wrangling.html#cb147-26"></a><span class="co">## 2      Brazil  37737  80488</span></span>
<span id="cb147-27"><a href="data-wrangling.html#cb147-27"></a><span class="co">## 3       China 212258 213766</span></span>
<span id="cb147-28"><a href="data-wrangling.html#cb147-28"></a>table4 <span class="co"># population</span></span>
<span id="cb147-29"><a href="data-wrangling.html#cb147-29"></a><span class="co">##       country       1999       2000</span></span>
<span id="cb147-30"><a href="data-wrangling.html#cb147-30"></a><span class="co">## 1 Afghanistan   19987071   20595360</span></span>
<span id="cb147-31"><a href="data-wrangling.html#cb147-31"></a><span class="co">## 2      Brazil  172006362  174504898</span></span>
<span id="cb147-32"><a href="data-wrangling.html#cb147-32"></a><span class="co">## 3       China 1272915272 1280428583</span></span></code></pre></div>
<p>Each shows the same data (counts of tuberculosis and total population for Afghanistan, Brazil, and China between 1999 and 2000), but each represents that data in a slightly different way, with slightly different consequences for your downstream workflow.</p>
<p>So, what tabular format should we choose? Here, I would like to recommend what Hadley <span class="citation">(<span class="citeproc-not-found" data-reference-id="Wickham2018"><strong>???</strong></span>)</span> refers to as a <em>tidy</em> format (that’s <code>table1</code> above). For rectangular data to be in a tidy format, it must satisfy these three rules:</p>
<ol style="list-style-type: decimal">
<li>Each variable must have its own column.<br />
</li>
<li>Each observation must have its own row.<br />
</li>
<li>Each value must have its own cell.</li>
</ol>
<p>These are represented graphically in our toy table, as shown in Fig. <a href="data-wrangling.html#fig:r-tidy-data">11.1</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:r-tidy-data"></span>
<img src="images/r-tidy_df.png" alt="Graphical representation of tidy terms."  />
<p class="caption">
Figure 11.1: Graphical representation of tidy terms.
</p>
</div>
<p>Why care about making your data tidy? As <span class="citation">(<span class="citeproc-not-found" data-reference-id="Wickham"><strong>???</strong></span>)</span> points out, there are two primary reasons:</p>
<ol style="list-style-type: decimal">
<li>Having a consistent format for your data means you can rely on a consistent set of tools for managing it.<br />
</li>
<li>Constraining each column to a single variable means you can take advantage of R’s vectorized functions. For instance, if you are trying to scale and center a variable, you will find this easier to achieve if its values are contained in a single column rather than spread out across multiple columns.</li>
</ol>
<p>So, now we know what the tidy format is and why we should use it. The obvious question to ask next is how we actually get our data into that format. If you find yourself in the position of trying to get your data into a tidy format, this implies that it is currently <em>not</em> in a tidy format, not necessarily <em>messy</em>, <em>per se</em>, just untidy. The two big ways that a dataset can be untidy are</p>
<ol style="list-style-type: decimal">
<li>Having observations spread out across multiple rows (like <code>table2</code>).</li>
<li>Having variables spread out across multiple columns (like <code>table3</code> and <code>table4</code>).</li>
</ol>
<p>Base R provides the <code>reshape()</code> function to tidy tables that commit these sins. Before reviewing this function, let’s first be honest about it. It’s poorly written (or at least, it’s written with a very narrowly defined motivation, namely, longitudinal data), and it behaves in a very strange and usually frustrating way. For these reasons, I am reluctant to explain how to use it. It’s a bit like teaching someone English using common expressions from Victorian England. But, I’m going to do it anyway, if only to make you familiar with it. So, hold your nose now and let’s forge ahead.</p>
<p>When you use <code>reshape()</code>, you are doing one of two things: (a) making the table <em>longer</em> by <em>stacking</em> columns containing values for the same variable, thus increasing the number of rows, or (b) making the table <em>wider</em> by <em>unstacking</em> columns containing values for multiple variables, thus increasing the number of columns. This is shown graphically in <a href="data-wrangling.html#fig:r-pivoting">11.2</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:r-pivoting"></span>
<img src="images/r-pivoting.png" alt="Graphical representation of reshaping a data.frame."  />
<p class="caption">
Figure 11.2: Graphical representation of reshaping a data.frame.
</p>
</div>
<p>As an example, let’s consider <code>table3</code>, which has values of the <code>year</code> variable stored as column names, specifically <code>1999</code> and <code>2000</code>, and the values of the <code>cases</code> variable stored across both columns. To get this into a tidy format, we need to (a) combine those column <em>names</em> into a single variable and place that variable in a column with the name <em>year</em> and (b) combine the column <em>values</em> into a single variable and place that variable in a column with the name <em>cases</em>. In terms of <code>reshape()</code> parameters, we need to do the following:</p>
<ol style="list-style-type: decimal">
<li>Point to the columns we are collapsing using the <code>varying</code> argument,</li>
<li>Specify the name of the new column we are going to move the original column <em>names</em> to using the <code>timevar</code> parameter,</li>
<li>Define the values of that column (which are the original column names) using the <code>times</code> parameter,</li>
<li>Specify what column we are going to move the column <em>values</em> to using the <code>v.names</code> argument, and</li>
<li>Specify the <code>direction</code> in which we are reshaping, in this case <em>long</em>.</li>
</ol>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="data-wrangling.html#cb148-1"></a>long_table3 &lt;-<span class="st"> </span><span class="kw">reshape</span>(table3, </span>
<span id="cb148-2"><a href="data-wrangling.html#cb148-2"></a>                       <span class="dt">varying =</span> <span class="kw">c</span>(<span class="st">&#39;1999&#39;</span>, <span class="st">&#39;2000&#39;</span>), </span>
<span id="cb148-3"><a href="data-wrangling.html#cb148-3"></a>                       <span class="dt">v.names =</span> <span class="st">&quot;cases&quot;</span>, </span>
<span id="cb148-4"><a href="data-wrangling.html#cb148-4"></a>                       <span class="dt">timevar =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb148-5"><a href="data-wrangling.html#cb148-5"></a>                       <span class="dt">times =</span> <span class="kw">c</span>(<span class="dv">1999</span>, <span class="dv">2000</span>),</span>
<span id="cb148-6"><a href="data-wrangling.html#cb148-6"></a>                       <span class="dt">direction =</span> <span class="st">&quot;long&quot;</span>)</span>
<span id="cb148-7"><a href="data-wrangling.html#cb148-7"></a></span>
<span id="cb148-8"><a href="data-wrangling.html#cb148-8"></a></span>
<span id="cb148-9"><a href="data-wrangling.html#cb148-9"></a>long_table3</span>
<span id="cb148-10"><a href="data-wrangling.html#cb148-10"></a><span class="co">##            country year  cases id</span></span>
<span id="cb148-11"><a href="data-wrangling.html#cb148-11"></a><span class="co">## 1.1999 Afghanistan 1999    745  1</span></span>
<span id="cb148-12"><a href="data-wrangling.html#cb148-12"></a><span class="co">## 2.1999      Brazil 1999  37737  2</span></span>
<span id="cb148-13"><a href="data-wrangling.html#cb148-13"></a><span class="co">## 3.1999       China 1999 212258  3</span></span>
<span id="cb148-14"><a href="data-wrangling.html#cb148-14"></a><span class="co">## 1.2000 Afghanistan 2000   2666  1</span></span>
<span id="cb148-15"><a href="data-wrangling.html#cb148-15"></a><span class="co">## 2.2000      Brazil 2000  80488  2</span></span>
<span id="cb148-16"><a href="data-wrangling.html#cb148-16"></a><span class="co">## 3.2000       China 2000 213766  3</span></span></code></pre></div>
<p>This has two unwanted side effects: (i) row names, which you should never ever use, and (ii) an additional <code>id</code> column, which is redundant considering we have the <code>country</code> column. Given the limitations of <code>reshape()</code>, it is not easy to address these side effects within the function call itself, so our best bet is to remove these manually like so:</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="data-wrangling.html#cb149-1"></a><span class="kw">row.names</span>(long_table3) &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb149-2"><a href="data-wrangling.html#cb149-2"></a></span>
<span id="cb149-3"><a href="data-wrangling.html#cb149-3"></a>long_table3<span class="op">$</span>id &lt;-<span class="st"> </span><span class="ot">NULL</span></span>
<span id="cb149-4"><a href="data-wrangling.html#cb149-4"></a></span>
<span id="cb149-5"><a href="data-wrangling.html#cb149-5"></a>long_table3</span>
<span id="cb149-6"><a href="data-wrangling.html#cb149-6"></a><span class="co">##       country year  cases</span></span>
<span id="cb149-7"><a href="data-wrangling.html#cb149-7"></a><span class="co">## 1 Afghanistan 1999    745</span></span>
<span id="cb149-8"><a href="data-wrangling.html#cb149-8"></a><span class="co">## 2      Brazil 1999  37737</span></span>
<span id="cb149-9"><a href="data-wrangling.html#cb149-9"></a><span class="co">## 3       China 1999 212258</span></span>
<span id="cb149-10"><a href="data-wrangling.html#cb149-10"></a><span class="co">## 4 Afghanistan 2000   2666</span></span>
<span id="cb149-11"><a href="data-wrangling.html#cb149-11"></a><span class="co">## 5      Brazil 2000  80488</span></span>
<span id="cb149-12"><a href="data-wrangling.html#cb149-12"></a><span class="co">## 6       China 2000 213766</span></span></code></pre></div>
<p>It is rare that you will want or need to <code>reshape()</code> in the <em>wide</em> direction, but here is an example just in case:</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="data-wrangling.html#cb150-1"></a>wide_table3 &lt;-<span class="st"> </span><span class="kw">reshape</span>(long_table3,</span>
<span id="cb150-2"><a href="data-wrangling.html#cb150-2"></a>                       <span class="dt">v.names =</span> <span class="st">&quot;cases&quot;</span>,</span>
<span id="cb150-3"><a href="data-wrangling.html#cb150-3"></a>                       <span class="dt">idvar =</span> <span class="st">&quot;country&quot;</span>,</span>
<span id="cb150-4"><a href="data-wrangling.html#cb150-4"></a>                       <span class="dt">timevar =</span> <span class="st">&quot;year&quot;</span>,</span>
<span id="cb150-5"><a href="data-wrangling.html#cb150-5"></a>                       <span class="dt">direction =</span> <span class="st">&quot;wide&quot;</span>)</span>
<span id="cb150-6"><a href="data-wrangling.html#cb150-6"></a></span>
<span id="cb150-7"><a href="data-wrangling.html#cb150-7"></a><span class="kw">names</span>(wide_table3) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;country&quot;</span>, <span class="st">&quot;1999&quot;</span>, <span class="st">&quot;2000&quot;</span>)</span>
<span id="cb150-8"><a href="data-wrangling.html#cb150-8"></a></span>
<span id="cb150-9"><a href="data-wrangling.html#cb150-9"></a>wide_table3</span>
<span id="cb150-10"><a href="data-wrangling.html#cb150-10"></a><span class="co">##       country   1999   2000</span></span>
<span id="cb150-11"><a href="data-wrangling.html#cb150-11"></a><span class="co">## 1 Afghanistan    745   2666</span></span>
<span id="cb150-12"><a href="data-wrangling.html#cb150-12"></a><span class="co">## 2      Brazil  37737  80488</span></span>
<span id="cb150-13"><a href="data-wrangling.html#cb150-13"></a><span class="co">## 3       China 212258 213766</span></span></code></pre></div>
<p>Basically, you are undoing the reverse of <code>reshape()</code> in the <em>long</em> direction. You tell the function which column is providing the values of the new columns with <code>v.names</code>, which column is providing the names of the new columns with <code>timevar</code>, and which column is providing the objects being described by the data with <code>idvar</code>. Finally, you set <code>direction = "wide"</code>.</p>
</div>
<div id="transforming-data" class="section level2">
<h2><span class="header-section-number">11.3</span> Transforming data</h2>
<p>Let’s start with something simple like changing the order of rows in a data.frame.</p>
<div id="arrange" class="section level3">
<h3><span class="header-section-number">11.3.1</span> Arrange</h3>
<p>On occasion you might want to re-order a data.frame, specifically changing the order in which rows appear. One would prefer that base R provide a simple function that does just that, taking a data.frame as input, along with a specification of which variable or variables should be used to re-order rows, and returning the re-ordered data.frame as output. Unfortunately, that does not exist. The base solution, thus, requires some finagling. Specifically, you need to create an index vector of the re-ordered rows and use that on the data.frame. To create the index vector, we use the <code>order()</code> function. The entire procedure looks like this:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="data-wrangling.html#cb151-1"></a>df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">&quot;c1&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">77</span>, <span class="dv">19</span>, <span class="dv">25</span>),</span>
<span id="cb151-2"><a href="data-wrangling.html#cb151-2"></a>                 <span class="st">&quot;c2&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>, <span class="st">&quot;E&quot;</span>),</span>
<span id="cb151-3"><a href="data-wrangling.html#cb151-3"></a>                 <span class="st">&quot;c3&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>))</span>
<span id="cb151-4"><a href="data-wrangling.html#cb151-4"></a></span>
<span id="cb151-5"><a href="data-wrangling.html#cb151-5"></a><span class="co"># create index vector</span></span>
<span id="cb151-6"><a href="data-wrangling.html#cb151-6"></a>i &lt;-<span class="st"> </span><span class="kw">order</span>(df<span class="op">$</span>c1, <span class="dt">decreasing =</span> <span class="ot">FALSE</span>)</span>
<span id="cb151-7"><a href="data-wrangling.html#cb151-7"></a></span>
<span id="cb151-8"><a href="data-wrangling.html#cb151-8"></a>df<span class="op">$</span>c1</span>
<span id="cb151-9"><a href="data-wrangling.html#cb151-9"></a><span class="co">## [1]  4  3 77 19 25</span></span>
<span id="cb151-10"><a href="data-wrangling.html#cb151-10"></a>i</span>
<span id="cb151-11"><a href="data-wrangling.html#cb151-11"></a><span class="co">## [1] 2 1 4 5 3</span></span>
<span id="cb151-12"><a href="data-wrangling.html#cb151-12"></a>df[i, ]</span>
<span id="cb151-13"><a href="data-wrangling.html#cb151-13"></a><span class="co">##   c1 c2    c3</span></span>
<span id="cb151-14"><a href="data-wrangling.html#cb151-14"></a><span class="co">## 2  3  B  TRUE</span></span>
<span id="cb151-15"><a href="data-wrangling.html#cb151-15"></a><span class="co">## 1  4  A  TRUE</span></span>
<span id="cb151-16"><a href="data-wrangling.html#cb151-16"></a><span class="co">## 4 19  D  TRUE</span></span>
<span id="cb151-17"><a href="data-wrangling.html#cb151-17"></a><span class="co">## 5 25  E FALSE</span></span>
<span id="cb151-18"><a href="data-wrangling.html#cb151-18"></a><span class="co">## 3 77  C FALSE</span></span></code></pre></div>
<p>Note, that you can order by increasing values of the variable (<code>decreasing = FALSE</code>) or decreasing values of the variable (<code>increasing = TRUE</code>).</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="data-wrangling.html#cb152-1"></a>i &lt;-<span class="st"> </span><span class="kw">order</span>(df<span class="op">$</span>c1, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>)</span>
<span id="cb152-2"><a href="data-wrangling.html#cb152-2"></a></span>
<span id="cb152-3"><a href="data-wrangling.html#cb152-3"></a>i</span>
<span id="cb152-4"><a href="data-wrangling.html#cb152-4"></a><span class="co">## [1] 3 5 4 1 2</span></span>
<span id="cb152-5"><a href="data-wrangling.html#cb152-5"></a>df[i, ]</span>
<span id="cb152-6"><a href="data-wrangling.html#cb152-6"></a><span class="co">##   c1 c2    c3</span></span>
<span id="cb152-7"><a href="data-wrangling.html#cb152-7"></a><span class="co">## 3 77  C FALSE</span></span>
<span id="cb152-8"><a href="data-wrangling.html#cb152-8"></a><span class="co">## 5 25  E FALSE</span></span>
<span id="cb152-9"><a href="data-wrangling.html#cb152-9"></a><span class="co">## 4 19  D  TRUE</span></span>
<span id="cb152-10"><a href="data-wrangling.html#cb152-10"></a><span class="co">## 1  4  A  TRUE</span></span>
<span id="cb152-11"><a href="data-wrangling.html#cb152-11"></a><span class="co">## 2  3  B  TRUE</span></span></code></pre></div>
</div>
<div id="change" class="section level3">
<h3><span class="header-section-number">11.3.2</span> Change</h3>
<p>[<code>transform()</code>]</p>
</div>
<div id="filter" class="section level3">
<h3><span class="header-section-number">11.3.3</span> Filter</h3>
<p>[<code>subset()</code>]</p>
</div>
<div id="select" class="section level3">
<h3><span class="header-section-number">11.3.4</span> Select</h3>
<p>[<code>subset()</code>]</p>
</div>
<div id="combine" class="section level3">
<h3><span class="header-section-number">11.3.5</span> Combine</h3>
<p>[<code>rbind()</code>, <code>cbind()</code>, <code>merge()</code>]</p>
<div class="figure" style="text-align: center"><span id="fig:r-join-dfs"></span>
<img src="images/r-join_dfs.png" alt="Results of different merge parameters and their SQL equivalents." width="90%" />
<p class="caption">
Figure 11.3: Results of different merge parameters and their SQL equivalents.
</p>
</div>
</div>
<div id="clean" class="section level3">
<h3><span class="header-section-number">11.3.6</span> Clean</h3>

</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="vector-indexing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="whatisstats.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["modtheworld.pdf", "modtheworld.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
